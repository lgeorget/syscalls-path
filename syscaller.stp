global SY_syscaller_pid = -1, SY_syscaller = ""

probe syscall.$1
{
	if (SY_syscaller_pid == -1 && SY_syscaller == execname()) {
		SY_syscaller_pid = pid()
		printf("%s -> %s [%s]\n", thread_indent(0), ppfunc(), $$vars)
	}
}

probe syscall.$1.return
{
	if (SY_syscaller_pid ==  pid()) {
		printf("%s <- %s [%s]\n", thread_indent(0), ppfunc(), $$vars)
		exit()
	}
}

probe kernel.function(@2).call, kernel.function("*@security/**/*.c").call
{
	if (SY_syscaller_pid == pid()) {
		printf("%s -> %s [%s]\n", thread_indent(2), ppfunc(), $$vars)
	}
}

probe kernel.function(@2).call, kernel.function("*@security/**/*.c").return
{
	if (SY_syscaller_pid == pid()) {
		printf("%s <- %s [%s]\n", thread_indent(-2), ppfunc(), $$vars)
	}
}
